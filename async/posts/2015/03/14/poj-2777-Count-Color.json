{"tags":[{"name":"线段树区间染色","permalink":"http://lzy-foenix.github.io/tags/线段树区间染色/","url":"\\async\\tags\\线段树区间染色.json","count":2}],"categories":[{"name":"数据结构","permalink":"http://lzy-foenix.github.io/categories/数据结构/","url":"\\async\\categories\\数据结构.json","count":18}],"url":"\\async\\posts\\2015\\03\\14\\poj-2777-Count-Color.json","date":1426284704000,"path":{"year":2015,"month":3,"day":14,"name":"poj-2777-Count-Color"},"title":"poj-2777-Count Color","permalink":"http://lzy-foenix.github.io/2015/03/14/poj-2777-Count-Color/","content":"<hr>\n<a id=\"more\"></a>\n<h3 id=\"题解：\"><a href=\"#题解：\" class=\"headerlink\" title=\"题解：\"></a>题解：</h3><p>线段树区间染色的裸题</p>\n<h3 id=\"代码：\"><a href=\"#代码：\" class=\"headerlink\" title=\"代码：\"></a>代码：</h3><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div><div class=\"line\">92</div><div class=\"line\">93</div><div class=\"line\">94</div><div class=\"line\">95</div><div class=\"line\">96</div><div class=\"line\">97</div><div class=\"line\">98</div><div class=\"line\">99</div><div class=\"line\">100</div></pre></td><td class=\"code\"><pre><div class=\"line\">#include &lt;cstdio&gt;</div><div class=\"line\">#include &lt;cstdlib&gt;</div><div class=\"line\">#include &lt;cstring&gt;</div><div class=\"line\">#include &lt;set&gt;</div><div class=\"line\">#include &lt;cmath&gt;</div><div class=\"line\">#include &lt;queue&gt;</div><div class=\"line\">#include &lt;ctime&gt;</div><div class=\"line\">#include &lt;iostream&gt;</div><div class=\"line\">#include &lt;algorithm&gt;</div><div class=\"line\">#define L(x) (x&lt;&lt;1)</div><div class=\"line\">#define R(x) (x&lt;&lt;1|1)</div><div class=\"line\">using namespace std;</div><div class=\"line\">const int MAXN=100005;</div><div class=\"line\">int N,T,M,Ans;</div><div class=\"line\">struct node&#123;</div><div class=\"line\">\tint l,r,col;</div><div class=\"line\">\tbool cover;</div><div class=\"line\">&#125;Seq_tree[MAXN&lt;&lt;2];</div><div class=\"line\">void Build(int root,int l,int r)&#123;</div><div class=\"line\">\tSeq_tree[root].l=l; Seq_tree[root].r=r;</div><div class=\"line\">\tSeq_tree[root].col=1; Seq_tree[root].cover=true;</div><div class=\"line\">\tif(Seq_tree[root].l==Seq_tree[root].r)return;</div><div class=\"line\">\tint mid=(l+r)&gt;&gt;1;</div><div class=\"line\">\tBuild(L(root),l,mid); Build(R(root),mid+1,r);</div><div class=\"line\">&#125;</div><div class=\"line\">void PushDown(int root)&#123;</div><div class=\"line\">\tSeq_tree[L(root)].col=Seq_tree[root].col;</div><div class=\"line\">\tSeq_tree[L(root)].cover=true;</div><div class=\"line\">\tSeq_tree[R(root)].col=Seq_tree[root].col;</div><div class=\"line\">\tSeq_tree[R(root)].cover=true;</div><div class=\"line\">\tSeq_tree[root].cover=false;</div><div class=\"line\">&#125;</div><div class=\"line\">void Updata(int root,int l,int r,int val)&#123;</div><div class=\"line\">\tif(l&lt;=Seq_tree[root].l &amp;&amp; r&gt;=Seq_tree[root].r)&#123;</div><div class=\"line\">\t\tSeq_tree[root].col=val;</div><div class=\"line\">\t\tSeq_tree[root].cover=true;</div><div class=\"line\">\t\treturn;</div><div class=\"line\">\t&#125;</div><div class=\"line\">\tif(Seq_tree[root].col==val)</div><div class=\"line\">\t\treturn;</div><div class=\"line\">\tif(Seq_tree[root].cover)</div><div class=\"line\">\t\tPushDown(root);</div><div class=\"line\">\tint mid=(Seq_tree[root].l+Seq_tree[root].r)&gt;&gt;1;</div><div class=\"line\">\tif(r&lt;=mid)Updata(L(root),l,r,val);</div><div class=\"line\">\telse if(l&gt;mid)Updata(R(root),l,r,val);</div><div class=\"line\">\telse&#123;</div><div class=\"line\">\t\tUpdata(L(root),l,mid,val);</div><div class=\"line\">\t\tUpdata(R(root),mid+1,r,val);</div><div class=\"line\">\t&#125;</div><div class=\"line\">\tSeq_tree[root].col=Seq_tree[L(root)].col | Seq_tree[R(root)].col;</div><div class=\"line\">&#125;</div><div class=\"line\">void Query(int root,int l,int r)&#123;</div><div class=\"line\">\tif(l&lt;=Seq_tree[root].l &amp;&amp; r&gt;=Seq_tree[root].r)&#123;</div><div class=\"line\">\t\tAns=Ans|Seq_tree[root].col;</div><div class=\"line\">\t\treturn;</div><div class=\"line\">\t&#125;</div><div class=\"line\">\tif(Seq_tree[root].cover)&#123;</div><div class=\"line\">\t\tAns=Ans|Seq_tree[root].col;</div><div class=\"line\">\t\treturn;</div><div class=\"line\">\t&#125;</div><div class=\"line\">\tint mid=(Seq_tree[root].l+Seq_tree[root].r)&gt;&gt;1;</div><div class=\"line\">\tif(r&lt;=mid)Query(L(root),l,r);</div><div class=\"line\">\telse if(l&gt;mid)Query(R(root),l,r);</div><div class=\"line\">\telse&#123;</div><div class=\"line\">\t\tQuery(L(root),l,mid);</div><div class=\"line\">\t\tQuery(R(root),mid+1,r);</div><div class=\"line\">\t&#125;</div><div class=\"line\">&#125;</div><div class=\"line\">int Solve()&#123;</div><div class=\"line\">\tint ans=0;</div><div class=\"line\">\twhile(Ans)&#123;</div><div class=\"line\">\t\tif(Ans&amp;1)ans++;</div><div class=\"line\">\t\tAns&gt;&gt;=1;</div><div class=\"line\">\t&#125;</div><div class=\"line\">\treturn ans;</div><div class=\"line\">&#125;</div><div class=\"line\">int main()&#123;</div><div class=\"line\">\tchar ch[10];int a,b,c;</div><div class=\"line\">\twhile(~scanf(\"%d%d%d\",&amp;N,&amp;T,&amp;M))&#123;</div><div class=\"line\">\t\tBuild(1,1,N);</div><div class=\"line\">\t\tfor(int i=1;i&lt;=M;i++)&#123;</div><div class=\"line\">\t\t\tscanf(\"%s\",ch);</div><div class=\"line\">\t\t\tif(ch[0]=='C')&#123;</div><div class=\"line\">\t\t\t\tscanf(\"%d%d%d\",&amp;a,&amp;b,&amp;c);</div><div class=\"line\">\t\t\t\tif(a&gt;b)swap(a,b);</div><div class=\"line\">\t\t\t\tUpdata(1,a,b,1&lt;&lt;(c-1));</div><div class=\"line\">\t\t\t&#125;</div><div class=\"line\">\t\t\telse&#123;</div><div class=\"line\">\t\t\t\tscanf(\"%d%d\",&amp;a,&amp;b);</div><div class=\"line\">\t\t\t\tif(a&gt;b)swap(a,b);</div><div class=\"line\">\t\t\t\tAns=0;</div><div class=\"line\">\t\t\t\tQuery(1,a,b);</div><div class=\"line\">\t\t\t\tprintf(\"%d\\n\",Solve());</div><div class=\"line\">\t\t\t&#125;</div><div class=\"line\">\t\t&#125;</div><div class=\"line\">\t&#125;</div><div class=\"line\">\tfclose(stdin);</div><div class=\"line\">\tfclose(stdout);</div><div class=\"line\">\treturn 0;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>"}