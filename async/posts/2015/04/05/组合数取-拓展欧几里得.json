{"tags":[{"name":"组合数","permalink":"http://lzy-foenix.github.io/tags/组合数/","url":"\\async\\tags\\组合数.json","count":2}],"categories":[{"name":"数学","permalink":"http://lzy-foenix.github.io/categories/数学/","url":"\\async\\categories\\数学.json","count":24}],"url":"\\async\\posts\\2015\\04\\05\\组合数取-拓展欧几里得.json","date":1428205102000,"path":{"year":2015,"month":4,"day":5,"name":"组合数取-拓展欧几里得"},"title":"组合数取模-拓展欧几里得","permalink":"http://lzy-foenix.github.io/2015/04/05/组合数取-拓展欧几里得/","content":"<hr>\n<a id=\"more\"></a>\n<h3 id=\"详解\"><a href=\"#详解\" class=\"headerlink\" title=\"详解\"></a>详解</h3><p>最近做了codechef上的一个比赛，有一个题是组合数取摸，其中n,m &lt;= $10^{9}$ ，共有100组数据，用Lucas的话，妥妥的超时，这是我们要用拓展欧几里得，使用条件是取摸的是素数。</p>\n<p>C(n,m)的表示是$n!/m!(n-m)! \\mod p$ 我们先预处理出$n!$和$m!$之后我们令$a=n!,b=m!(n-m)!$式子可以转换为$a/b \\equiv x(\\mod p)$因为p是素数，所以我们的式子就可以变换为$b\\cdot x+p\\cdot y = a$进而变换$b’\\cdot x+p’\\cdot y=1$所以我们用拓展欧几里得求出x，之后答案就是$x\\cdot a$</p>\n<h3 id=\"题目及代码\"><a href=\"#题目及代码\" class=\"headerlink\" title=\"题目及代码\"></a>题目及代码</h3><p><a href=\"http://www.codechef.com/APRIL15/problems/CSEQ\" target=\"_blank\" rel=\"external\">Codechef April Challenge 2015 Count Sequences</a><br><figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;cstdio&gt;</span></span></div><div class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;memory&gt;</span></span></div><div class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;cstring&gt;</span></span></div><div class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;iostream&gt;</span></span></div><div class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> <span class=\"built_in\">std</span>;</div><div class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"keyword\">long</span> <span class=\"keyword\">long</span> LL;</div><div class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> mod=<span class=\"number\">1000003</span>;</div><div class=\"line\">LL a[mod];</div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">init</span><span class=\"params\">()</span></span>&#123;</div><div class=\"line\">\t<span class=\"keyword\">int</span> i;</div><div class=\"line\">\ta[<span class=\"number\">0</span>]=<span class=\"number\">1</span>;</div><div class=\"line\">\t<span class=\"keyword\">for</span>(i=<span class=\"number\">1</span>;i&lt;mod;i++)</div><div class=\"line\">\t\ta[i]=(a[i<span class=\"number\">-1</span>]*i)%mod;</div><div class=\"line\">&#125;</div><div class=\"line\"><span class=\"function\">LL <span class=\"title\">gcd</span><span class=\"params\">(LL a,LL b)</span></span>&#123;<span class=\"keyword\">return</span> b==<span class=\"number\">0</span>? a:gcd(b,a%b);&#125;</div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">e_gcd</span><span class=\"params\">(LL a,LL b,LL &amp;x,LL &amp;y)</span> </span>&#123;<span class=\"comment\">//计算ax+by=1</span></div><div class=\"line\">\t<span class=\"keyword\">if</span>(!b)&#123;</div><div class=\"line\">\t\tx=<span class=\"number\">1</span>;</div><div class=\"line\">\t\ty=<span class=\"number\">0</span>;</div><div class=\"line\">\t&#125;</div><div class=\"line\">\t<span class=\"keyword\">else</span>&#123;</div><div class=\"line\">\t\te_gcd(b,a%b,x,y);</div><div class=\"line\">\t\t<span class=\"keyword\">int</span> l=x;</div><div class=\"line\">\t\tx=y;</div><div class=\"line\">\t\ty=l-a/b*y;</div><div class=\"line\">\t&#125;</div><div class=\"line\">&#125;</div><div class=\"line\"><span class=\"function\">LL <span class=\"title\">choose</span><span class=\"params\">(LL n,LL m)</span></span>&#123;</div><div class=\"line\">\t<span class=\"keyword\">if</span>(m&gt;n)</div><div class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</div><div class=\"line\">\t<span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(n==m)</div><div class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"number\">1</span>;</div><div class=\"line\">\tLL nn=a[n],mm=(a[m]*a[n-m])%mod;</div><div class=\"line\">\tLL d=gcd(nn,mm);</div><div class=\"line\">\tnn/=d;</div><div class=\"line\">\tmm/=d;</div><div class=\"line\">\tLL x,y;</div><div class=\"line\">\te_gcd(mm,mod,x,y);</div><div class=\"line\">\tx=(x+mod)%mod;</div><div class=\"line\">\t<span class=\"keyword\">return</span> (x*nn)%mod;</div><div class=\"line\">&#125;</div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">( )</span></span>&#123;</div><div class=\"line\">\t<span class=\"comment\">//freopen(\"1.in\",\"r\",stdin);</span></div><div class=\"line\">\t<span class=\"comment\">//freopen(\"3.out\",\"w\",stdout);</span></div><div class=\"line\">\t<span class=\"keyword\">int</span> t;</div><div class=\"line\">\t<span class=\"built_in\">scanf</span>(<span class=\"string\">\"%d\"</span>,&amp;t);</div><div class=\"line\">\tinit();</div><div class=\"line\">\t<span class=\"keyword\">while</span>(t--)&#123;</div><div class=\"line\">\t\tLL e[<span class=\"number\">100</span>],f[<span class=\"number\">100</span>];</div><div class=\"line\">\t\tLL i=<span class=\"number\">0</span>,j,n,l,r,m;</div><div class=\"line\">\t\t<span class=\"built_in\">memset</span>(e,<span class=\"number\">0</span>,<span class=\"keyword\">sizeof</span>(e));</div><div class=\"line\">\t\t<span class=\"built_in\">memset</span>(f,<span class=\"number\">0</span>,<span class=\"keyword\">sizeof</span>(f));</div><div class=\"line\">\t\t<span class=\"built_in\">scanf</span>(<span class=\"string\">\"%lld%lld%lld\"</span>,&amp;n,&amp;l,&amp;r);</div><div class=\"line\">\t\tm=n; n=n+r-l+<span class=\"number\">1</span>;</div><div class=\"line\">\t\t<span class=\"keyword\">while</span>(n&gt;<span class=\"number\">0</span>)&#123;</div><div class=\"line\">\t\t\te[i++]=n%mod;</div><div class=\"line\">\t\t\tn=n/mod;</div><div class=\"line\">\t\t&#125;</div><div class=\"line\">\t\tLL len=i;</div><div class=\"line\">\t\ti=<span class=\"number\">0</span>;</div><div class=\"line\">\t\t<span class=\"keyword\">while</span>(m&gt;<span class=\"number\">0</span>)&#123;</div><div class=\"line\">\t\t\tf[i++]=m%mod;</div><div class=\"line\">\t\t\tm=m/mod;</div><div class=\"line\">\t\t&#125;</div><div class=\"line\">\t\tLL re=<span class=\"number\">1</span>;</div><div class=\"line\">\t\t<span class=\"keyword\">for</span>(i=<span class=\"number\">0</span>;i&lt;len;i++)&#123;</div><div class=\"line\">\t\t\tre=(re*choose(e[i],f[i]))%mod;</div><div class=\"line\">\t\t&#125;</div><div class=\"line\">\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">\"%lld\\n\"</span>,((re<span class=\"number\">-1</span>)+mod)%mod);</div><div class=\"line\">\t&#125;</div><div class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n"}